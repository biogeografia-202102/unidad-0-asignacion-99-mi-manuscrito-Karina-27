\documentclass[11pt,]{article}
\usepackage[left=1in,top=1in,right=1in,bottom=1in]{geometry}
\newcommand*{\authorfont}{\fontfamily{phv}\selectfont}
\usepackage[]{mathpazo}


  \usepackage[T1]{fontenc}
  \usepackage[utf8]{inputenc}



\usepackage{abstract}
\renewcommand{\abstractname}{}    % clear the title
\renewcommand{\absnamepos}{empty} % originally center

\renewenvironment{abstract}
 {{%
    \setlength{\leftmargin}{0mm}
    \setlength{\rightmargin}{\leftmargin}%
  }%
  \relax}
 {\endlist}

\makeatletter
\def\@maketitle{%
  \newpage
%  \null
%  \vskip 2em%
%  \begin{center}%
  \let \footnote \thanks
    {\fontsize{18}{20}\selectfont\raggedright  \setlength{\parindent}{0pt} \@title \par}%
}
%\fi
\makeatother




\setcounter{secnumdepth}{3}

\usepackage{longtable,booktabs}

\usepackage{graphicx,grffile}
\makeatletter
\def\maxwidth{\ifdim\Gin@nat@width>\linewidth\linewidth\else\Gin@nat@width\fi}
\def\maxheight{\ifdim\Gin@nat@height>\textheight\textheight\else\Gin@nat@height\fi}
\makeatother
% Scale images if necessary, so that they will not overflow the page
% margins by default, and it is still possible to overwrite the defaults
% using explicit options in \includegraphics[width, height, ...]{}
\setkeys{Gin}{width=\maxwidth,height=\maxheight,keepaspectratio}

\title{Técnicas de Ecología numérica aplicadas a la comunidad de
Chrysobalanaceae representada en la parcela permanente de Barro Colorado
Island (BCI)  }



\author{\Large Melany Karina Ogando Matos\vspace{0.05in} \newline\normalsize\emph{Estudiante, Universidad Autónoma de Santo Domingo (UASD)}  }


\date{}

\usepackage{titlesec}

\titleformat*{\section}{\normalsize\bfseries}
\titleformat*{\subsection}{\normalsize\itshape}
\titleformat*{\subsubsection}{\normalsize\itshape}
\titleformat*{\paragraph}{\normalsize\itshape}
\titleformat*{\subparagraph}{\normalsize\itshape}

\titlespacing{\section}
{0pt}{36pt}{0pt}
\titlespacing{\subsection}
{0pt}{36pt}{0pt}
\titlespacing{\subsubsection}
{0pt}{36pt}{0pt}





\newtheorem{hypothesis}{Hypothesis}
\usepackage{setspace}

\makeatletter
\@ifpackageloaded{hyperref}{}{%
\ifxetex
  \PassOptionsToPackage{hyphens}{url}\usepackage[setpagesize=false, % page size defined by xetex
              unicode=false, % unicode breaks when used with xetex
              xetex]{hyperref}
\else
  \PassOptionsToPackage{hyphens}{url}\usepackage[unicode=true]{hyperref}
\fi
}

\@ifpackageloaded{color}{
    \PassOptionsToPackage{usenames,dvipsnames}{color}
}{%
    \usepackage[usenames,dvipsnames]{color}
}
\makeatother
\hypersetup{breaklinks=true,
            bookmarks=true,
            pdfauthor={Melany Karina Ogando Matos (Estudiante, Universidad Autónoma de Santo Domingo (UASD))},
             pdfkeywords = {ecología numérica, BCI, Chrysobalanaceae, correlación, agrupamiento,
biodiversidad},  
            pdftitle={Técnicas de Ecología numérica aplicadas a la comunidad de
Chrysobalanaceae representada en la parcela permanente de Barro Colorado
Island (BCI)},
            colorlinks=true,
            citecolor=blue,
            urlcolor=blue,
            linkcolor=magenta,
            pdfborder={0 0 0}}
\urlstyle{same}  % don't use monospace font for urls

% set default figure placement to htbp
\makeatletter
\def\fps@figure{htbp}
\makeatother

\usepackage{pdflscape} \newcommand{\blandscape}{\begin{landscape}}
\newcommand{\elandscape}{\end{landscape}} \usepackage{float}
\floatplacement{figure}{H}
\newcommand{\beginsupplement}{ \setcounter{table}{0} \renewcommand{\thetable}{S\arabic{table}} \setcounter{figure}{0} \renewcommand{\thefigure}{S\arabic{figure}} }


% add tightlist ----------
\providecommand{\tightlist}{%
\setlength{\itemsep}{0pt}\setlength{\parskip}{0pt}}

\begin{document}
	
% \pagenumbering{arabic}% resets `page` counter to 1 
%
% \maketitle

{% \usefont{T1}{pnc}{m}{n}
\setlength{\parindent}{0pt}
\thispagestyle{plain}
{\fontsize{18}{20}\selectfont\raggedright 
\maketitle  % title \par  

}

{
   \vskip 13.5pt\relax \normalsize\fontsize{11}{12} 
\textbf{\authorfont Melany Karina Ogando Matos} \hskip 15pt \emph{\small Estudiante, Universidad Autónoma de Santo Domingo (UASD)}   

}

}








\begin{abstract}

    \hbox{\vrule height .2pt width 39.14pc}

    \vskip 8.5pt % \small 

\noindent Los patrones de dispersión y agrupamiento de las especies revelan
información acerca de como estas interactúan con el medio ambiente. El
objetivo de esta investigación es conocer el patrón de distribución de
las especies de Chrysobalanaceae que se encuentran representadas en BCI
utilizando técnicas de ecología númerica. Los métodos realizados
incluyen análisis de agrupamiento, técnicas de ordenación, medidas de la
diversidad y análisis de ecología espacial. Los resultados demostraron
que existe una correlación espacial inducida por las variables
ambientales. \emph{Licania }hypoleuca demostró ser una especie
indicadora para uno de los grupos formado por el análisis de
agrupamiento. Como se trata de datos censales se demostró la completitud
de la muestra por medio de estimadores de riqueza. Los sitios de BCI se
encuentran altamente correlacionados en función de las variables
ambientales, por lo que la riqueza por sitio es lo que caracteriza cada
uno de estos.


\vskip 8.5pt \noindent \emph{Keywords}: ecología numérica, BCI, Chrysobalanaceae, correlación, agrupamiento,
biodiversidad \par

    \hbox{\vrule height .2pt width 39.14pc}



\end{abstract}


\vskip 6.5pt


\noindent  \section{Introducción}\label{introducciuxf3n}

Conocer la dispersion y las formas de agrupamiento de los individuos de
una especie, es necesario para su conservacion (Condit et al., 1996,
Hubbell \& Foster (1992)). Las especies no son las mismas en todos los
lugares, y estos patrones de variación, en cada uno de los niveles de
diversidad: genes, especies y ecosistemas, es el objeto de estudio de la
biogeografía. Su objetivo es caracterizar la distribucion de las
especies en la actualidad y la variacion geografica de la diversidad en
términos de la interacción de los organismos con su ambiente (Lomolino,
Riddle, Whittaker, \& Brown, 2010). La similiridad es una medida simple
de la similitud de especies y sus abundancias. Es convencional decir que
es lo mismo alta diversidad con alta homogeneidad, lo que es equivalente
a poca dominancia (Magurran, 2004).

Los patrones de biodiversidad son el resultado de la combinacion de los
procesos internos de la comunidad de plantas y las condiciones externas
del ambiente (Sang \& Bai, 2008). Por ejemplo, la cantidad de nitrogeno
en el suelo puede ser asumida como una limitante directa en la
distribucion de las especies de plantas (Lange, Nobel, Osmond, \&
Ziegler, 2013). Numerosas especies de la familia Chrysobalanaceae poseen
preferencia por suelos húmedos (Regional Conservation (2020), Future
(2021), C. Sothers, Prance, Buerki, De Kok, \& Chase (2014), Grandtner
\& Chevrette (2013)).Esta es una familia de plantas de distribucion
pantropical, y cuenta con 18 géneros con 531 especies que se encuentra
un 80\% en el neotrópico.(G. Prance, 2014, Bardon et al. (2013)).

Las especies de Chrysobalaneceae son utilizadas de maneras distintas
para el tratamiento y como medicina de algunas enfermedades como la
malaria, epilepsia, diarrea y diabetes (Feitosa, Xavier, \& Randau,
2012). Sus usos son frecuentes en la región africana y surámericana,
donde son más abundantes (Feitosa et al., 2012). Posee diferentes usos
como: El aceite de sus frutos para pinturas y varnices, tambien su
madera como material de construccion, combustible y carbón. Ademas es
utilizada mezclada con arcilla para hacer vasijas de barro (G. Prance,
2014).

La parcela permanente de la isla de Barro Colorado es una reserva de
investigacion biologica a cargo del Smithsonian Tropical Research
Institute (Croat, 1978).\\
Segun Condit (1998) la distribucion de \emph{Hirtella americana} en la
parcela permanente de BCI se encuentra de manera irregular en pequeñas
areas isoladas. Sin embargo, los estudios realizados no han demostrado
que esta irregularidad se deba a variables ambientales. Croat (1978)
menciona que \emph{Hirtella americana} es una de las especies mayor
representadas por su densidad en este bosque.

Con el motivo de aplicar estudios de ecología numérica y aprender a
utilizarlos en futuras investigaciones, además de descubrir si existen
patrones de correlación entre la familia de plantas Chrysobalanaceae y
algunas variables ambientales, esta investigación tiene como objetivos
conocer la distribución espacial de las especies de la familia
Chrysobalanaceae, conoces si se agrupan en grupos discontinuos en
función de su composición, y reconocer si estos patrones se encuentran
relacionados con alguna variable ambiental. Además de identificar, en
caso de que existan, las tendencias de ordenación de la especies de
Chrysobalanaceae representadas en BCI y su correspondencia con las
variables del ambiente. Este estudio busca estimar la riqueza de la
familia Chrysobalanceae en la parcela permanente de Barro Colorado
Island y descubir la relación entre la diversidad alpha y las variables
ambientales, además de la relación de las especies con la diversidad
beta. Tambien identificar si los modelos de distribución de especies
predicen la ocurrencia de las especies representadas en el estudio.

Para realizar un estudio a fondo de la correlación entre esta familia y
las variables ambientales era necesario realizar multiples analisis de
ecología numerica, por esta razon se realizaron analisis de
agrupamiento, tecnicas de ordenacion, analaisis de diversidad y ecología
espacial. Ya que cada uno responde a distintas preguntas de
investigación. Este estudio intenta resumir los patrones de diversidad
asociados a la familia Chrysobalanaceae en la parcela permanente de BCI.

\section{Metodología}\label{metodologuxeda}

\subsection{Obtención de los datos}\label{obtenciuxf3n-de-los-datos}

Los datos fueron obtenidos del censo realizado durante el 2010 por el
Smithsonian Tropical Research Institute en la parcela permanente de
Barro Colorado Island en el lago Gatún, Panamá (S. Hubbell, Condit, \&
Foster, 2010). En este censo, se contabilizaron todas las árboles con
troncos de al menos 10mm de Diámetro de Altura de Pecho, y estos fueron
identificados y marcados. Esta parcela cuenta con 50 hectáreas dividida
en 50 cuadros de 1 hectárea cada una.

\begin{figure}
\centering
\includegraphics[width=0.50000\textwidth]{mapa_cuadros_panama.png}
\caption{Parcela de 50-ha de Barro Colorado Island,
Panamá\label{mapaBCIcuadros}}
\end{figure}

Los datos utilizados en esta investigación fueron administrados a través
del repositorio Batlle (2020). Estos datos continenen la matriz de
comunidad y la matriz ambiental. En la matriz de comunidad se extrajeron
los datos de la familia Chrysobalanaceae.

\subsection{Análisis estadístico}\label{anuxe1lisis-estaduxedstico}

Para conocer los patrones de agrupamiento según la composición de
especies de Chrysobalanaceae se realizó un análisis de agrupamiento
tomando en consideración cuatro técnicas jerarquicas y aglomerativas
(Borcard, Gillet, Legendre, \& others, 2011, Krebs (2014)), las cuales
fueron: por enlace simple,por enlace completo, por enlace promedio
(UPGMA) y por el método de Ward. Los datos de la matriz de comunidad
fueron normalizados y se calculó la distancia euclídea, para luego
proceder a realizar las técnicas de agrupamiento.

Para conocer el patrón de organización de la familia Chrysobalanaceae y
seleccionar el dendrograma que mejor explica las relaciones entre las
especies de esta familia, se realizaron pruebas de distancia cofenética;
y para conocer el número de grupos óptimo se calculó la anchura de
siluetas. Por medio de Bootstrap multiescalar se revisaron los datos
obtenidos en los métodos anteriores. Para evaluar la relación de los
grupos obtenidos con las variables ambientales se utilizó una prueba de
igualdad de promedios por t student y la prueba no paramétrica de la
suma de rangos de Wilcoxon (medianas). Además, se realizó un análisis de
especies indicadoras mediante la prueba de IndVal y un analisis de
especies con preferencia por hábitat mediante el coeficiente de
correlación biserial puntual (Phi).

Las técnicas de ordenación consisten en colocar objetos o variables en
un espacio donde cada uno representa una dimensión (Borcard et al.,
2011). Los gráficos generados mediante estos análisis muestran una
relación ordenada de las variables formando un diagrama de dispersión
(Legendre \& Legendre, 2012, Legendre \& Gallagher (2001)).

A fin de detectar las tendencias de ordenación de las especies de la
familia Chrysobalanaceae se utilizaron diferentes técnicas de tipo
restringida y no restringida. El análisis de componentes principales
(PCA) se realizó para variables ambientales utilizando solo las
variables numéricas y escalándolas a puntuaciones Z para generar una
matriz de correlaciones; para las variables de la matriz de comunidad
los datos fueron transformados basados en Hellinger. El análisis de
correspondencia (CA) se realizó calculando las distancias de los objetos
en CHI cuadradro. La técnicas de ordenación restringida utilizada fue un
análisis de correspondencia canónica (CCA).

Para el análisis de la diversidad Alpha se calcularon los números de
diversidad Alpha y los ratios de Hill como se encuentra explicado por
Krebs (2014) y Borcard et al. (2011). Los sitios que poseían solo una
especie fueron excluidos. Posteriormente, se realizó un análisis de
correlacion de pearson con las variables ambientales seleccionadas, para
conocer si existe asociación con la diversidad Alpha. Con el objetivo de
medir la diversidad de especies de una localidad cuando solo se tienen
una muestra de la riqueza total de la comunidad, se utilizó el enfoque
asintótico no paramétrico de Chao. La diversidad beta calculada con los
datos de presencia/ausencia de las especies nos dice cúantas más
especies están presentes en toda el área que en un sitio individual
(Borcard et al., 2011). La contribución local de los sitios y las
especies a la diversidad beta fue realizada siguiendo los procedimientos
indicados por Borcard et al. (2011).

Uno de los fundamentos de la ecología espacial es comprender como el
espacio impacta en la estructura de la comunidad (Cantrell, Cosner, \&
Ruan, 2010). La autocorrelación espacial es una medida de la similaridad
o disimilaridad de dos sitios cercanos con relación a los pares
seleccionados aleatoriamente {[}borcard2011numerical{]}. El análisis de
correlacción espacial se realizó siguiendo la metodología descrita por
Batlle (2020). En primer lugar, los datos de la matriz de comunidad
fueron transformados midiendo la distancia Hellinger, y se generó la
vecindad para la matriz ambiental. Entonces, la autocorrelación de las
especies y las variables ambientales se midió a partir de un
correlograma. Posteriormente, se eliminaron las tendencias espaciales de
autocorrelación transformando la matriz de comunidad Hellinger en una
matriz de posiciones XY, para luego realizar una prueba Mantel de
correlograma. De igual forma, se evaluó la autocorrelación espacial por
I de Moran sin tomar en cuenta las tendencias espaciales.

Los análisis fueron realizados en la consola de RStudio (R Core Team,
2020) administrada por José Ramón Martínez Batlle. Para acceder a la
consola se realizó mediante el navegador Google Chrome en una
computadora personal de prestaciones básicas. Los paquetes utilizados
para los diferentes análisis fueron Oksanen et al. (2019), R. Kindt \&
Coe (2005), Wickham (2017) y De Caceres \& Legendre (2009).

\section{Resultados}\label{resultados}

La familia Chrysobalanaceae se encuentra representada en BCI por un
total de 4,821 individuos formada por las especies \emph{Hirtella
americana}, \emph{Hirtella triandra}, \emph{Licania platypus} y
\emph{Licania hypoleuca} \ref{tab:abun_sp}. La especie más abundante fue
\emph{Hirtella triandra}, que representa un 90\% de la composición de la
familia en BCI.

\begin{longtable}[]{@{}lr@{}}
\caption{\label{tab:abun_sp}Tabla de abundancias de las especies de
Chrysobalanaceae en BCI}\tabularnewline
\toprule
Latin & n\tabularnewline
\midrule
\endfirsthead
\toprule
Latin & n\tabularnewline
\midrule
\endhead
Hirtella triandra & 4408\tabularnewline
Licania platypus & 251\tabularnewline
Licania hypoleuca & 141\tabularnewline
Hirtella americana & 21\tabularnewline
\bottomrule
\end{longtable}

Los análisis de agrupamiento por medio de las cuatro técnicas mostraron
grupos similares, con un grupo consistente en todas las técnicas formado
por los sitios 24, 25, 29 y 30. Los dendrogramas que mostraron mayor
correlación cofenética fueron los creados por los métodos de enlace
completo y enlace promedio (UPGMA). El número de grupos obtenido
mediante el cálculo de anchura de silueta fue de dos para los
dendrogramas generados por enlace completo, por enlace pormedio (UPGMA)
y por Ward.

El mapa de calor generado para los dendrogramas muestra ligeramente la
apariencia de tres grupos, sin embargo el análisis mediante boostrap
multiescalar refuerza la partición en solo dos grupos para UPGMA, Ward y
por enlace completo. Ya que los dendrogramas generados por UPGMA y por
enlace completo mostraron resultados muy similares, los dendrogramas
utilizados para posteriores análisis fueron los generados por medio de
agrupamiento por enlace completo y Ward para dos grupos óptimos
\ref{clusters}. El grupo uno formado por 46 sitios y el grupo dos
formado por 4 sitios \ref{mapagrupos}.

\begin{figure}
\centering
\includegraphics[width=1.00000\textwidth]{Clusters.png}
\caption{Dendrogramas generados por análisis de
agrupamiento\label{clusters}}
\end{figure}

\begin{figure}
\centering
\includegraphics[width=0.50000\textwidth]{mapa_ward_k2.png}
\caption{Mapa según grupos generados por análisis de
agrupamiento\label{mapagrupos}}
\end{figure}

Las pruebas de igualdad de promedios realizadas por medio de t-student y
la suma de rangos de Wilcoxon mostró que las variables heterogeneidad
ambiental, Nitrógeno y elevación media muestran relación significativa
con los grupos formados por medio del análisis de agrupamiento.

Los análisis de especies indicadoras o con preferencia por determinados
hábitats dio como resultado que \emph{Licania hypoleuca} parece ser una
especie indicadora para el grupo 2 (formado por los sitios 24, 25, 29 y
30).

Mediante el cálculo de los factores de inflación (VIF) de las variables
de suelo y ambientales se escogió un grupo reducido de variables que
tuvieran poca correlación entre ellas con un VIF menor de 10. Las
variables escogidos fueron Aluminio, Cobre, Manganeso, Nitrógeno, pH,
Nitrógeno mineralizado, elevación media, heterogeneidad ambiental y
orientación media.

El análisis de componentes principales para los datos de variables
ambientales seleccionadas dio como resultado que los sitios se asocian
en dos grupos distintivos, sin embargo estos grupos no se corresponden
con los generados por medio del análisis de agrupamiento por enlace
completo (\ref{pcagroup}).

\begin{figure}
\centering
\includegraphics[width=0.80000\textwidth]{PCA_porgrupos.png}
\caption{Analisis de Componentes Principales por grupos\label{pcagroup}}
\end{figure}

El análisis de componentes principales (PCA) aplicado a la matriz de
comunidad muestra la relación de \emph{Licania hypoleuca} con los sitios
del grupo 2 del análisis de agrupamiento generado por enlace completo
\ref{pcaespecies}, al igual que en el análisis de correspondecia. Esta
especie parece asociarse de manera inversa con la abundancia de
Manganeso. Las especies \emph{Hirtella triandra} e \emph{Hirtella
americana} presentan correlación inversa, pues los vectores se muestran
en direcciones completamente opuestas.

\begin{figure}
\centering
\includegraphics[width=0.80000\textwidth]{PCA_especies.png}
\caption{PCA escalamiento 2 con ajuste a variables
seleccionadas\label{pcaespecies}}
\end{figure}

Los resultados del análisis de correspondencia canónica explican un 47\%
de los datos y en la grafica se puede verificar que \emph{Hirtella
triandra} es la especie con mayor abundancia, pues se encuentra en el
centro del gráfico. También se muestra que \emph{Licania platypus} se
encuentra muy correlacionada con la abundancia de nitrógeno mineralizado
(\ref{triplotrda}).

\begin{figure}
\centering
\includegraphics[width=0.80000\textwidth]{triplotRDA.png}
\caption{Triplot de RDA de especies en escalamiento 2\label{triplotrda}}
\end{figure}

Las variables ambientales Magnesio, Zinc, Nitrógeno mineralizado y
geomorfología de interfluvio mostraron relación con los números de Hill.
Mientras que pH y Nitrógeno parecen estar correlacionadas con la equidad
de Pielou (\ref{diversidadalpha}). El trabajo de muestreo realizado en
BCI con relación a la familia Chrysobalanaceae se estima que representa
un 100\% de completitud de la muestra, según los estimadores de Chao
\ref{extrapolacion}, por lo que podemos afirmar que esta familia se
encuentra muy bien representada en BCI.

\begin{figure}
\centering
\includegraphics[width=0.80000\textwidth]{diversidadalpha.png}
\caption{Análisis de Correlación de Pearson aplicados a índices de
diversidad según variables ambientales\label{diversidadalpha}}
\end{figure}

\begin{figure}
\centering
\includegraphics[width=0.80000\textwidth]{Extrapolacion_mifamilia.png}
\caption{Gráfico de rarefacción para toda la
comunidad\label{extrapolacion}}
\end{figure}

Sin embargo, al realizar la estimación de la riqueza por medio de los
estimadores de Chao para los grupos generados en el análisis de
agrupamiento, se estima que el grupo 1 se encuentra representado en un
100\%, pero para el grupo 2 es necesario aumentar el esfuerzo de
muestreo. Esto puede deberse a la desigualdad del número de sitios en
los grupos.

La diversidad beta multiplicativa disminuye mientras aumenta la
importancia de la abundancia más que la riqueza, esto se debe a la
autocorrelación espacial de los sitios, y demuestra que la diversidad de
la comunidad está marcada por la presencia de especies indicadoras. Las
especies que muestran contribución a la diversidad beta son
\emph{Licania hypoleuca} y \emph{Licania platypus}, mientras que ninguno
de los sitios resultó como contribuyente.

Mediante la prueba de correlograma las variables Boro, Calcio, Magnesio,
Zinc, Nitrógeno, pH y Nitrógeno mineralizado mostraron correlación en
múltiples órdenes (\ref{correlograma}). La prueba Mantel sin tendencias
de autocorrelación muestra que en los residuos la correlación no es
significativa, por lo que parece que hay una dependencia espacial
inducida por las variables ambientales. El I de moran aplicado a la
matriz sin tendencia espacial dio como resultado que \emph{Licania
hypoleuca} e \emph{Hirtella triandra} se encuentran en un patrón
aglomerativo (\ref{lisamaps}). Las variable que muestra un patrón
aglomerativo común es la elevación media.

\begin{figure}
\centering
\includegraphics[width=0.80000\textwidth]{correlogramavariables.png}
\caption{Correlograma de variables ambientales\label{correlograma}}
\end{figure}

\begin{figure}
\centering
\includegraphics[width=0.80000\textwidth]{clusterlisaespecies.png}
\caption{Mapas Lisa generados para las especies de Chrysobalanaceae y
elvación media\label{lisamaps}}
\end{figure}

\section{Discusión}\label{discusiuxf3n}

La composición de especies de la familia Chrysobalanaceae en BCI no
parece organizarse en patrones discontinuos, aunque los análisis de
agrupamiento muestran un grupo formado por los sitios 24, 25, 29 y 30
que se caracteriza por la abundancia de \emph{Licania hypoleuca}.

Las técnicas de análisis de ordenación al comparar sitios y especies
demuestra, al igual que el análisis de agrupamiento, que los sitios del
grupo 2 se encuentran correlacionados con la abundancia de \emph{Licania
hypoleuca}. Esta tendencia de ordenación parece asociarse de manera
inversa con la abundancia de Manganeso, además este análisis muestra que
la abundancia de \emph{Licania platypus} se correlaciona con el
nitrógeno mineralizado.

Debido a que el método de muestreo utilizado para generar la base de
datos usada en esta investigación se trata de un censo, es por esto que
el análisis de estimación de riqueza muestra una alta completitud de la
muestra. Las especies raras son el mayor contribuyente a la diversidad
beta de la comunidad.

Los datos parecen mostrar una correlación espacial inducida alta. Sin
embargo, al general los mapas Lisa las especies \emph{Licania hypoleuca}
e \emph{Hirtella triandra} solo parecen mostrar un patrón aglomerado con
respecto a la orientación media.

Se recomienda aplicar otras técnicas de ecología numérica a estos datos
para comparar los resultados de la variables selecionadas, y verificar
los modelos de agrupamiento obtenidos además de como se relacionan con
las variables ambientales.

\section{Agradecimientos}\label{agradecimientos}

Agradezco al profesor José Martínez Batlle por sus enseñanzas y su apoyo
en el análisis de esta investigación. También al Smithsonian Tropical
Research Institute por la obtención y el suministro de los datos.

\section{\texorpdfstring{\emph{Script}
reproducible}{Script reproducible}}\label{script-reproducible}

\begin{verbatim}
## Warning in readLines("Script_rep.R"): incomplete final line found on
## 'Script_rep.R'
\end{verbatim}

\begin{verbatim}
##   [1] "#' Cargar paquetes"                                                                                                                                                    
##   [2] "#'"                                                                                                                                                                    
##   [3] "library(vegan)"                                                                                                                                                        
##   [4] "library(tidyverse)"                                                                                                                                                    
##   [5] "library(sf)"                                                                                                                                                           
##   [6] "source('biodata/funciones.R')"                                                                                                                                         
##   [7] "#'"                                                                                                                                                                    
##   [8] "#' Cargar datos"                                                                                                                                                       
##   [9] "load('biodata/Chrysobalanaceae.Rdata')"                                                                                                                                
##  [10] "load('biodata/matriz_ambiental.Rdata')"                                                                                                                                
##  [11] "bci_env_grid %>% tibble"                                                                                                                                               
##  [12] "censo_chrys %>% tibble"                                                                                                                                                
##  [13] "#'"                                                                                                                                                                    
##  [14] "grupos_ward_k2 <- readRDS('grupos_ward_k2.RDS')"                                                                                                                       
##  [15] "table(grupos_ward_k2)"                                                                                                                                                 
##  [16] "grupos_compl_k2 <- readRDS('grupos_compl_k2.RDS')"                                                                                                                     
##  [17] "table(grupos_compl_k2)"                                                                                                                                                
##  [18] "#'"                                                                                                                                                                    
##  [19] "#' Analisis Exploratorio"                                                                                                                                              
##  [20] "#' Lista de especies: 4"                                                                                                                                               
##  [21] "sort(colnames(mc_chrys))"                                                                                                                                              
##  [22] "#'"                                                                                                                                                                    
##  [23] "#' Abundancia de toda la comunidad"                                                                                                                                    
##  [24] "sum(colSums(mc_chrys))"                                                                                                                                                
##  [25] "#'"                                                                                                                                                                    
##  [26] "#' Abundancia por cuadrante"                                                                                                                                           
##  [27] "sort(rowSums(mc_chrys))"                                                                                                                                               
##  [28] "#'"                                                                                                                                                                    
##  [29] "#' Abundancia por especie"                                                                                                                                             
##  [30] "sort(colSums(mc_chrys))"                                                                                                                                               
##  [31] "#'"                                                                                                                                                                    
##  [32] "#' Tabla de abundancias"                                                                                                                                               
##  [33] "abun_sp <- censo_chrys %>%"                                                                                                                                            
##  [34] "  group_by(Latin) %>% "                                                                                                                                                
##  [35] "  count() %>% "                                                                                                                                                        
##  [36] "  arrange(desc(n))"                                                                                                                                                    
##  [37] "abun_sp"                                                                                                                                                               
##  [38] "#'"                                                                                                                                                                    
##  [39] "#' Cargar otros paquetes"                                                                                                                                              
##  [40] "library(cluster)"                                                                                                                                                      
##  [41] "library(gclus)"                                                                                                                                                        
##  [42] "library(pvclust)"                                                                                                                                                      
##  [43] "library(mapview)"                                                                                                                                                      
##  [44] "library(RColorBrewer)"                                                                                                                                                 
##  [45] "library(broom)"                                                                                                                                                        
##  [46] "library(indicspecies)"                                                                                                                                                 
##  [47] "#'"                                                                                                                                                                    
##  [48] "#' Crear abreviaturas de la familia"                                                                                                                                   
##  [49] "mi_fam <- mc_chrys"                                                                                                                                                    
##  [50] "(colnames(mi_fam) <- make.cepnames(colnames(mi_fam)))"                                                                                                                 
##  [51] "(df_equivalencias <- data.frame("                                                                                                                                      
##  [52] "  nombre_original = colnames(mc_chrys),"                                                                                                                               
##  [53] "  colnames(mi_fam)))"                                                                                                                                                  
##  [54] "#'"                                                                                                                                                                    
##  [55] "#'#' Cargar paletas de colores"                                                                                                                                        
##  [56] "rojo <- colorRampPalette(brewer.pal(8, \"Reds\"))"                                                                                                                     
##  [57] "rojo_inv <- colorRampPalette(rev(brewer.pal(8, \"Reds\")))"                                                                                                            
##  [58] "colores_grupos <- brewer.pal(8, \"Accent\")"                                                                                                                           
##  [59] "#'"                                                                                                                                                                    
##  [60] "#' Analisis de Agrupamiento"                                                                                                                                           
##  [61] "#'"                                                                                                                                                                    
##  [62] "mi_fam_norm <- decostand(mi_fam, \"normalize\")"                                                                                                                       
##  [63] "mi_fam_norm_d <- vegdist(mi_fam_norm, \"euc\")"                                                                                                                        
##  [64] "mi_fam_norm_d %>% tidy"                                                                                                                                                
##  [65] "attr(mi_fam_norm_d, \"labels\") <- rownames(mi_fam)"                                                                                                                   
##  [66] "#' Enlace completo"                                                                                                                                                    
##  [67] "(cl_complete <- hclust(mi_fam_norm_d, method = 'complete'))"                                                                                                           
##  [68] "plot(cl_complete, labels = rownames(mi_fam), hang = -1,"                                                                                                               
##  [69] "     main = \"Sitios de BCI según composición de especies de Chrysobalanaceae\\nEnlace completo a partir de matriz de distancia de cuerdas\","                         
##  [70] "     xlab = 'Sitios', ylab = 'Altura')"                                                                                                                                
##  [71] "#' Por medio de Ward"                                                                                                                                                  
##  [72] "(cl_ward <- hclust(mi_fam_norm_d, method = 'ward.D2'))"                                                                                                                
##  [73] "plot(cl_ward, labels = rownames(mi_fam), hang = -1,"                                                                                                                   
##  [74] "     main = \"Sitios de BCI según composición de especies de Chrysobalanaceae\\nMétodo de Ward a partir de matriz de distancia de cuerdas\","                          
##  [75] "     xlab = 'Sitios', ylab = 'Altura')"                                                                                                                                
##  [76] "#' "                                                                                                                                                                   
##  [77] "#' Medicion de la correlacion cofenetica"                                                                                                                              
##  [78] "#' "                                                                                                                                                                   
##  [79] "lista_cl <- list("                                                                                                                                                     
##  [80] "  cl_complete = hclust(mi_fam_norm_d, method = 'complete'),"                                                                                                           
##  [81] "  cl_ward = hclust(mi_fam_norm_d, method = 'ward.D2')"                                                                                                                 
##  [82] ")"                                                                                                                                                                     
##  [83] "par(mfrow = c(1,2))"                                                                                                                                                   
##  [84] "invisible(map(names(lista_cl), function(x) plot(lista_cl[[x]], main = x, hang = -1, cex.lab = 1)))"                                                                    
##  [85] "par(mfrow = c(1,1))"                                                                                                                                                   
##  [86] "map_df(lista_cl, function(x) {"                                                                                                                                        
##  [87] "  coph_d <- cophenetic(x)"                                                                                                                                             
##  [88] "  corr <- cor(mi_fam_norm_d, coph_d)"                                                                                                                                  
##  [89] "  return(corr)"                                                                                                                                                        
##  [90] "})"                                                                                                                                                                    
##  [91] "#'"                                                                                                                                                                    
##  [92] "#' Calculo de la anchura de siluetas"                                                                                                                                  
##  [93] "#'"                                                                                                                                                                    
##  [94] "anch_sil_ward <- calcular_anchuras_siluetas("                                                                                                                          
##  [95] "  mc_orig = mi_fam, "                                                                                                                                                  
##  [96] "  distancias = mi_fam_norm_d, "                                                                                                                                        
##  [97] "  cluster = lista_cl$cl_ward)"                                                                                                                                         
##  [98] "anch_sil_ward"                                                                                                                                                         
##  [99] "w_dend_reord <- reorder.hclust(lista_cl$cl_ward, mi_fam_norm_d)"                                                                                                       
## [100] "plot(w_dend_reord, hang = -1)"                                                                                                                                         
## [101] "rect.hclust("                                                                                                                                                          
## [102] "  tree = w_dend_reord,"                                                                                                                                                
## [103] "  k = anch_sil_ward$n_grupos_optimo)"                                                                                                                                  
## [104] "heatmap("                                                                                                                                                              
## [105] "  as.matrix(mi_fam_norm_d),"                                                                                                                                           
## [106] "  Rowv = as.dendrogram(w_dend_reord),"                                                                                                                                 
## [107] "  symm = TRUE,"                                                                                                                                                        
## [108] "  margin = c(3, 3),"                                                                                                                                                   
## [109] "  col = rev(cm.colors(4))"                                                                                                                                             
## [110] ")"                                                                                                                                                                     
## [111] "#' Bootstrap"                                                                                                                                                          
## [112] "cl_pvclust_ward <-"                                                                                                                                                    
## [113] "  pvclust(t(mi_fam_norm),"                                                                                                                                             
## [114] "          method.hclust = \"ward.D2\","                                                                                                                                
## [115] "          method.dist = \"euc\","                                                                                                                                      
## [116] "          iseed = 191, # Resultado reproducible"                                                                                                                       
## [117] "          parallel = TRUE)"                                                                                                                                            
## [118] "plot(cl_pvclust_ward, hang = -1)"                                                                                                                                      
## [119] "lines(cl_pvclust_ward)"                                                                                                                                                
## [120] "pvrect(cl_pvclust_ward, alpha = 0.91, border = 4)"                                                                                                                     
## [121] "saveRDS(grupos_ward_k2, 'grupos_ward_k2.RDS')"                                                                                                                         
## [122] "#' Para complete"                                                                                                                                                      
## [123] "anch_sil_compl <- calcular_anchuras_siluetas("                                                                                                                         
## [124] "  mc_orig = mi_fam, "                                                                                                                                                  
## [125] "  distancias = mi_fam_norm_d, "                                                                                                                                        
## [126] "  cluster = lista_cl$cl_complete)"                                                                                                                                     
## [127] "anch_sil_compl"                                                                                                                                                        
## [128] "(grupos_ward_k2 <- as.factor(cutree(lista_cl$cl_ward, k = 2)))"                                                                                                        
## [129] "table(grupos_ward_k2)"                                                                                                                                                 
## [130] "#'"                                                                                                                                                                    
## [131] "w_dend_reord <- reorder.hclust(lista_cl$cl_complete, mi_fam_norm_d)"                                                                                                   
## [132] "plot(w_dend_reord, hang = -1)"                                                                                                                                         
## [133] "rect.hclust("                                                                                                                                                          
## [134] "  tree = w_dend_reord,"                                                                                                                                                
## [135] "  k = anch_sil_compl$n_grupos_optimo)"                                                                                                                                 
## [136] "#'"                                                                                                                                                                    
## [137] "heatmap("                                                                                                                                                              
## [138] "  as.matrix(mi_fam_norm_d),"                                                                                                                                           
## [139] "  Rowv = as.dendrogram(w_dend_reord),"                                                                                                                                 
## [140] "  symm = TRUE,"                                                                                                                                                        
## [141] "  margin = c(3, 3),"                                                                                                                                                   
## [142] "  col = rev(cm.colors(4))"                                                                                                                                             
## [143] ")"                                                                                                                                                                     
## [144] "#' Bootstrap"                                                                                                                                                          
## [145] "cl_pvclust_compl <-"                                                                                                                                                   
## [146] "  pvclust(t(mi_fam_norm),"                                                                                                                                             
## [147] "          method.hclust = \"complete\","                                                                                                                               
## [148] "          method.dist = \"euc\","                                                                                                                                      
## [149] "          iseed = 27, # Resultado reproducible"                                                                                                                        
## [150] "          parallel = TRUE)"                                                                                                                                            
## [151] "plot(cl_pvclust_compl, hang = -1)"                                                                                                                                     
## [152] "lines(cl_pvclust_compl)"                                                                                                                                               
## [153] "pvrect(cl_pvclust_compl, alpha = 0.91, border = 4)"                                                                                                                    
## [154] "(grupos_compl_k2 <- as.factor(cutree(lista_cl$cl_complete, k = 2)))"                                                                                                   
## [155] "table(grupos_compl_k2)"                                                                                                                                                
## [156] "saveRDS(grupos_compl_k2, 'grupos_compl_k2.RDS')"                                                                                                                       
## [157] "#'"                                                                                                                                                                    
## [158] "#' Mapa de grupos por medio de Ward"                                                                                                                                   
## [159] "(m_amb_ward_k2 <- bci_env_grid %>%"                                                                                                                                    
## [160] "    select_if(is.numeric) %>% select(-id) %>% "                                                                                                                        
## [161] "    mutate(grupos_ward_k2) %>%"                                                                                                                                        
## [162] "    st_drop_geometry() %>% "                                                                                                                                           
## [163] "    pivot_longer(-grupos_ward_k2, names_to = \"variable\", values_to = \"valor\"))"                                                                                    
## [164] "#' "                                                                                                                                                                   
## [165] "m_amb_ward_k2 %>%"                                                                                                                                                     
## [166] "  group_by(variable) %>%"                                                                                                                                              
## [167] "  summarise("                                                                                                                                                          
## [168] "    p_valor_t = t.test(valor ~ grupos_ward_k2)$p.value,"                                                                                                               
## [169] "    p_valor_w = wilcox.test(valor ~ grupos_ward_k2, exact = F)$p.value) %>%"                                                                                           
## [170] "  arrange(p_valor_t) %>%"                                                                                                                                              
## [171] "  print(n=Inf)"                                                                                                                                                        
## [172] "#' "                                                                                                                                                                   
## [173] "m_amb_ward_k2 %>% "                                                                                                                                                    
## [174] "  group_by(variable) %>% "                                                                                                                                             
## [175] "  ggplot() + aes(x = grupos_ward_k2, y = valor, fill = grupos_ward_k2) + "                                                                                             
## [176] "  geom_boxplot() + "                                                                                                                                                   
## [177] "  scale_fill_brewer(palette = 'Accent') +"                                                                                                                             
## [178] "  theme_bw() +"                                                                                                                                                        
## [179] "  theme(legend.position=\"none\") +"                                                                                                                                   
## [180] "  facet_wrap(~ variable, scales = 'free_y')"                                                                                                                           
## [181] "#' "                                                                                                                                                                   
## [182] "mapa_ward_k2 <- mapView("                                                                                                                                              
## [183] "  bci_env_grid %>% mutate(grupos_ward_k2),"                                                                                                                            
## [184] "  layer.name = 'Grupos (2) Ward',"                                                                                                                                     
## [185] "  alpha.regions = 0.6,"                                                                                                                                                
## [186] "  map.types = 'OpenTopoMap',"                                                                                                                                          
## [187] "  legend = T,"                                                                                                                                                         
## [188] "  col.regions = colores_grupos[1:2],"                                                                                                                                  
## [189] "  zcol = 'grupos_ward_k2') %>%"                                                                                                                                        
## [190] "  addStaticLabels(label = bci_env_grid$id) %>% "                                                                                                                       
## [191] "  leaflet::setView("                                                                                                                                                   
## [192] "    lng = -79.85136,"                                                                                                                                                  
## [193] "    lat = 9.15097,"                                                                                                                                                    
## [194] "    zoom = 16)"                                                                                                                                                        
## [195] "mapa_ward_k2"                                                                                                                                                          
## [196] "#' "                                                                                                                                                                   
## [197] "#' Especies indicadoras para Ward_k2"                                                                                                                                  
## [198] "iva_ward_k2 <- multipatt("                                                                                                                                             
## [199] "  x = mi_fam,"                                                                                                                                                         
## [200] "  cluster = grupos_ward_k2,"                                                                                                                                           
## [201] "  func = 'IndVal.g',"                                                                                                                                                  
## [202] "  max.order = 2,"                                                                                                                                                      
## [203] "  control = how(nperm = 999))"                                                                                                                                         
## [204] "summary(iva_ward_k2, indvalcomp = TRUE)"                                                                                                                               
## [205] "colSums(mi_fam)"                                                                                                                                                       
## [206] "(p_ward_adj <- p.adjust(iva_ward_k2$sign$p.value))"                                                                                                                    
## [207] "(iva_ward_boot <- strassoc("                                                                                                                                           
## [208] "  X = mi_fam,"                                                                                                                                                         
## [209] "  cluster = grupos_ward_k2,"                                                                                                                                           
## [210] "  func = \"IndVal.g\","                                                                                                                                                
## [211] "  nboot = 1000))"                                                                                                                                                      
## [212] "#'"                                                                                                                                                                    
## [213] "phi_ward_k2 <- multipatt("                                                                                                                                             
## [214] "  mi_fam,"                                                                                                                                                             
## [215] "  grupos_ward_k2,"                                                                                                                                                     
## [216] "  func = \"r.g\","                                                                                                                                                     
## [217] "  max.order = 2,"                                                                                                                                                      
## [218] "  control = how(nperm = 999))"                                                                                                                                         
## [219] "summary(phi_ward_k2)"                                                                                                                                                  
## [220] "colSums(mi_fam)"                                                                                                                                                       
## [221] "(phi_ward_boot <- strassoc("                                                                                                                                           
## [222] "  X = mi_fam,"                                                                                                                                                         
## [223] "  cluster = grupos_ward_k2,"                                                                                                                                           
## [224] "  func = \"r.g\","                                                                                                                                                     
## [225] "  nboot = 1000))"                                                                                                                                                      
## [226] "#'"                                                                                                                                                                    
## [227] "#' Cargar otros paquetes"                                                                                                                                              
## [228] "library(ape)"                                                                                                                                                          
## [229] "library(spdep)"                                                                                                                                                        
## [230] "library(ade4)"                                                                                                                                                         
## [231] "library(adegraphics)"                                                                                                                                                  
## [232] "library(adespatial)"                                                                                                                                                   
## [233] "library(gridExtra)"                                                                                                                                                    
## [234] "library(grid)"                                                                                                                                                         
## [235] "library(gtable)"                                                                                                                                                       
## [236] "library(magrittr)"                                                                                                                                                     
## [237] "library(plyr)"                                                                                                                                                         
## [238] "library(SpadeR)"                                                                                                                                                       
## [239] "library(iNEXT)"                                                                                                                                                        
## [240] "library(vegetarian)"                                                                                                                                                   
## [241] "source('https://raw.githubusercontent.com/maestria-geotel-master/unidad-3-asignacion-1-vecindad-autocorrelacion-espacial/master/lisaclusters.R')"                      
## [242] "#' Tecnicas de ordenacion"                                                                                                                                             
## [243] "env_select <- bci_env_grid %>% "                                                                                                                                       
## [244] "  st_drop_geometry %>%"                                                                                                                                                
## [245] "  dplyr::select_if(is.numeric) %>%"                                                                                                                                    
## [246] "  dplyr::select(-id) %>%"                                                                                                                                              
## [247] "  dplyr::select(Al, Cu, Mn, N, N.min., pH, elevacion_media, heterogeneidad_ambiental, orientacion_media)"                                                              
## [248] "env_select %>% tibble"                                                                                                                                                 
## [249] "#' Analisis de Componentes Principales"                                                                                                                                
## [250] "env_select_pca <- rda(env_select, scale = TRUE)"                                                                                                                       
## [251] "env_select_pca"                                                                                                                                                        
## [252] "summary(env_select_pca)"                                                                                                                                               
## [253] "#'"                                                                                                                                                                    
## [254] "par(mfrow = c(1, 2))"                                                                                                                                                  
## [255] "cleanplot.pca(env_select_pca, scaling = 1, mar.percent = 0.08, cex.char1 = 0.5)"                                                                                       
## [256] "cleanplot.pca(env_select_pca, scaling = 2, mar.percent = 0.04, cex.char1 = 0.5)"                                                                                       
## [257] "par(mfrow = c(1, 1))"                                                                                                                                                  
## [258] "#'"                                                                                                                                                                    
## [259] "(env_agrupamiento <- hclust(dist(scale(env_select)), 'ward.D'))"                                                                                                       
## [260] "(env_grupos <- cutree(env_agrupamiento, k = 2))"                                                                                                                       
## [261] "(mi_cluster <- factor(env_grupos))"                                                                                                                                    
## [262] "(mi_cluster_l <- levels(mi_cluster))"                                                                                                                                  
## [263] "(mi_cluster_l_seq <- 1:length(mi_cluster_l))"                                                                                                                          
## [264] "(puntuaciones <- scores(env_select_pca, display = 'wa', scaling = 1))"                                                                                                 
## [265] "par(mfrow = c(1, 2))"                                                                                                                                                  
## [266] "grafico_base <- plot("                                                                                                                                                 
## [267] "  env_select_pca,"                                                                                                                                                     
## [268] "  display = \"wa\","                                                                                                                                                   
## [269] "  scaling = 1,"                                                                                                                                                        
## [270] "  type = \"n\","                                                                                                                                                       
## [271] "  main = \"PCA según grupos por variables seleccionadas\""                                                                                                             
## [272] ")"                                                                                                                                                                     
## [273] "abline(v = 0, lty = \"dotted\")"                                                                                                                                       
## [274] "abline(h = 0, lty = \"dotted\")"                                                                                                                                       
## [275] "for (i in mi_cluster_l_seq) {"                                                                                                                                         
## [276] "  points(puntuaciones[mi_cluster == i, ],"                                                                                                                             
## [277] "         pch = (14 + i),"                                                                                                                                              
## [278] "         cex = 2,"                                                                                                                                                     
## [279] "         col = i + 1)"                                                                                                                                                 
## [280] "}"                                                                                                                                                                     
## [281] "text(puntuaciones, row.names(env_select), cex = 1, pos = 3)"                                                                                                           
## [282] "legend("                                                                                                                                                               
## [283] "  \"topleft\", # Otras alternativas: \"bottomleft\", \"bottomright\" y \"topleft\""                                                                                    
## [284] "  paste(\"Grupo\", c(mi_cluster_l_seq)),"                                                                                                                              
## [285] "  pch = 14 + c(mi_cluster_l_seq),"                                                                                                                                     
## [286] "  col = 1 + c(mi_cluster_l_seq),"                                                                                                                                      
## [287] "  pt.cex = 2"                                                                                                                                                          
## [288] ")"                                                                                                                                                                     
## [289] "#'"                                                                                                                                                                    
## [290] "(mi_cluster_anterior <- grupos_compl_k2)"                                                                                                                              
## [291] "(mi_cluster_anterior_l <- levels(mi_cluster_anterior))"                                                                                                                
## [292] "(mi_cluster_anterior_l_seq <- 1:length(mi_cluster_anterior_l))"                                                                                                        
## [293] "grafico_base <- plot("                                                                                                                                                 
## [294] "  env_select_pca,"                                                                                                                                                     
## [295] "  display = \"wa\","                                                                                                                                                   
## [296] "  scaling = 1,"                                                                                                                                                        
## [297] "  type = \"n\","                                                                                                                                                       
## [298] "  main = \"PCA según grupos por enlace completo\""                                                                                                                     
## [299] ")"                                                                                                                                                                     
## [300] "abline(v = 0, lty = \"dotted\")"                                                                                                                                       
## [301] "abline(h = 0, lty = \"dotted\")"                                                                                                                                       
## [302] "for (i in mi_cluster_anterior_l_seq) {"                                                                                                                                
## [303] "  points(puntuaciones[mi_cluster_anterior == i, ],"                                                                                                                    
## [304] "         pch = (14 + i),"                                                                                                                                              
## [305] "         cex = 2,"                                                                                                                                                     
## [306] "         col = i + 1)"                                                                                                                                                 
## [307] "}"                                                                                                                                                                     
## [308] "text(puntuaciones, row.names(env_select), cex = 1, pos = 3)"                                                                                                           
## [309] "legend("                                                                                                                                                               
## [310] "  \"topleft\", # Otras alternativas: \"bottomleft\", \"bottomright\" y \"topleft\""                                                                                    
## [311] "  paste(\"Grupo\", c(mi_cluster_anterior_l_seq)),"                                                                                                                     
## [312] "  pch = 14 + c(mi_cluster_anterior_l_seq),"                                                                                                                            
## [313] "  col = 1 + c(mi_cluster_anterior_l_seq),"                                                                                                                             
## [314] "  pt.cex = 2"                                                                                                                                                          
## [315] ")"                                                                                                                                                                     
## [316] "par(mfrow = c(1, 1))"                                                                                                                                                  
## [317] "#'"                                                                                                                                                                    
## [318] "#' PCA a datos de comunidad"                                                                                                                                           
## [319] "mi_fam_hel <- decostand(mi_fam, method = 'hellinger')"                                                                                                                 
## [320] "mi_fam_hel %>% tibble"                                                                                                                                                 
## [321] "mi_fam_hel_pca <- rda(mi_fam_hel)"                                                                                                                                     
## [322] "summary(mi_fam_hel_pca)"                                                                                                                                               
## [323] "#'"                                                                                                                                                                    
## [324] "biplot("                                                                                                                                                               
## [325] "  mi_fam_hel_pca,"                                                                                                                                                     
## [326] "  main = \"PCA escalamiento 2 con ajuste a variables seleccionadas\")"                                                                                                 
## [327] "(mi_fam_hel_pca_envfit <- envfit(mi_fam_hel_pca, env_select, scaling = 2))"                                                                                            
## [328] "plot(mi_fam_hel_pca_envfit, p.max = 0.05 , col = 3)"                                                                                                                   
## [329] "#'"                                                                                                                                                                    
## [330] "#' Analisis de Correspondencia"                                                                                                                                        
## [331] "mi_fam_ca <- cca(mi_fam)"                                                                                                                                              
## [332] "summary(mi_fam_ca)"                                                                                                                                                    
## [333] "summary(mi_fam_ca, scaling = 1)"                                                                                                                                       
## [334] "par(mfrow = c(1, 2))"                                                                                                                                                  
## [335] "plot(mi_fam_ca,"                                                                                                                                                       
## [336] "     scaling = 1,"                                                                                                                                                     
## [337] "     main = \"Análisis de correspondencia, escalamiento 1\""                                                                                                           
## [338] ")"                                                                                                                                                                     
## [339] "plot(mi_fam_ca,"                                                                                                                                                       
## [340] "     scaling = 2, # Por defecto scaling=2, lo escribo sólo para fines didáticos"                                                                                       
## [341] "     main = \"Análisis de correspondencia, escalamiento 2\")"                                                                                                          
## [342] "par(mfrow = c(1, 1))"                                                                                                                                                  
## [343] "#'"                                                                                                                                                                    
## [344] "#' Analisis de Redundancia"                                                                                                                                            
## [345] "mi_fam_hel <- decostand(mi_fam, method = 'hellinger')"                                                                                                                 
## [346] "mi_fam_hel %>% tibble"                                                                                                                                                 
## [347] "mi_fam_hel_rda_select <- rda(mi_fam_hel ~ ., env_select)"                                                                                                              
## [348] "summary(mi_fam_hel_rda_select)"                                                                                                                                        
## [349] "#'"                                                                                                                                                                    
## [350] "RsquareAdj(mi_fam_hel_rda_select)$adj.r.squared"                                                                                                                       
## [351] "vif.cca(mi_fam_hel_rda_select)"                                                                                                                                        
## [352] "#' "                                                                                                                                                                   
## [353] "#' Analisis de Correspondencia Canonica"                                                                                                                               
## [354] "mi_fam_cca_select <- cca(mi_fam ~ ., env_select)"                                                                                                                      
## [355] "summary(mi_fam_cca_select)"                                                                                                                                            
## [356] "RsquareAdj(mi_fam_cca_select)"                                                                                                                                         
## [357] "#' "                                                                                                                                                                   
## [358] "plot(mi_fam_cca_select,"                                                                                                                                               
## [359] "     scaling = 2,"                                                                                                                                                     
## [360] "     display = c(\"sp\", \"lc\", \"cn\"),"                                                                                                                             
## [361] "     main = \"Triplot de CCA especies según variables seleccionadas, escalamiento 2\""                                                                                 
## [362] ")"                                                                                                                                                                     
## [363] "#' "                                                                                                                                                                   
## [364] "#' Analisis de Diversidad"                                                                                                                                             
## [365] "#' "                                                                                                                                                                   
## [366] "(indices <- alpha_div(mi_fam))"                                                                                                                                        
## [367] "indices_sitios <- indices[-c(6,7,34,38,39),] #Para sitios con mas de una especie"                                                                                      
## [368] "pairs(indices_sitios,"                                                                                                                                                 
## [369] "      lower.panel = panel.smooth,"                                                                                                                                     
## [370] "      upper.panel = panel.cor,"                                                                                                                                        
## [371] "      diag.panel = panel.hist,"                                                                                                                                        
## [372] "      main = \"Pearson Correlation Matrix\")"                                                                                                                          
## [373] "#' "                                                                                                                                                                   
## [374] "indices_env <- bind_cols("                                                                                                                                             
## [375] "  indices_sitios,"                                                                                                                                                     
## [376] "  bci_env_grid[-c(6,7,34,38,39),] %>%"                                                                                                                                 
## [377] "    select_if(is.numeric) %>%"                                                                                                                                         
## [378] "    st_drop_geometry %>%"                                                                                                                                              
## [379] "    select(-id) %>% "                                                                                                                                                  
## [380] "    select(Mg, Zn, N.min., N, pH, orientacion_media, geomorf_interfluvio_pct))"                                                                                        
## [381] "indices_env %>% tibble"                                                                                                                                                
## [382] "ezCorM(indices_env, r_size_lims = c(3,5), label_size = 4)"                                                                                                             
## [383] "#'"                                                                                                                                                                    
## [384] "#' Modelos de abundancia de especies"                                                                                                                                  
## [385] "riqueza <- specnumber(mi_fam)"                                                                                                                                         
## [386] "abundancia <- rowSums(mi_fam)"                                                                                                                                         
## [387] "(rango_abun <- range(abundancia))"                                                                                                                                     
## [388] "riqueza_menor_abun <- rarefy(mi_fam, sample = rango_abun[1])"                                                                                                          
## [389] "sort(riqueza)"                                                                                                                                                         
## [390] "sort(round(riqueza_menor_abun))"                                                                                                                                       
## [391] "rarecurve("                                                                                                                                                            
## [392] "  mi_fam,"                                                                                                                                                             
## [393] "  step = 1,"                                                                                                                                                           
## [394] "  sample = rango_abun[1],"                                                                                                                                             
## [395] "  xlab = \"Número de individuos (tamaño de muestra)\","                                                                                                                
## [396] "  ylab = \"Especies\","                                                                                                                                                
## [397] "  label = TRUE,"                                                                                                                                                       
## [398] "  col = \"blue\""                                                                                                                                                      
## [399] ")"                                                                                                                                                                     
## [400] "#' Estimacion de la riqueza para toda la comunidad y para los grupos"                                                                                                  
## [401] "mi_fam_combinada <- colSums(mi_fam)"                                                                                                                                   
## [402] "mi_fam_combinada %>% sort"                                                                                                                                             
## [403] "mi_fam_combinada_chao <- estimacion_riqueza_chao("                                                                                                                     
## [404] "  mc = mi_fam_combinada,"                                                                                                                                              
## [405] "  n_raras = 22)"                                                                                                                                                       
## [406] "mi_fam_combinada_chao$asintoticos_estimacion"                                                                                                                          
## [407] "mi_fam_combinada_chao$no_asintoticos_rarefaccion_extrapolacion"                                                                                                        
## [408] "mi_fam_combinada_chao$no_asintoticos_rarefaccion_extrapolacion_grafico"                                                                                                
## [409] "#'"                                                                                                                                                                    
## [410] "mi_fam_k2 <- mi_fam %>%"                                                                                                                                               
## [411] "  mutate(g=grupos_ward_k2) %>%"                                                                                                                                        
## [412] "  group_by(g) %>%"                                                                                                                                                     
## [413] "  summarise_all(sum) %>%"                                                                                                                                              
## [414] "  select(-g) %>% "                                                                                                                                                     
## [415] "  data.frame"                                                                                                                                                          
## [416] "mi_fam_k2 %>% rowSums %>% sort"                                                                                                                                        
## [417] "mi_fam_k2_chao <- estimacion_riqueza_chao("                                                                                                                            
## [418] "  mc = mi_fam_k2,"                                                                                                                                                     
## [419] "  n_raras = 22)"                                                                                                                                                       
## [420] "mi_fam_k2_chao$asintoticos_estimacion"                                                                                                                                 
## [421] "mi_fam_k2_chao$no_asintoticos_rarefaccion_extrapolacion"                                                                                                               
## [422] "mi_fam_k2_chao$no_asintoticos_rarefaccion_extrapolacion_grafico"                                                                                                       
## [423] "#' "                                                                                                                                                                   
## [424] "#' Diversidad beta"                                                                                                                                                    
## [425] "determinar_contrib_local_y_especie("                                                                                                                                   
## [426] "  mc = mi_fam,"                                                                                                                                                        
## [427] "  alpha = 0.05,"                                                                                                                                                       
## [428] "  nperm = 9999,"                                                                                                                                                       
## [429] "  metodo = 'hellinger')"                                                                                                                                               
## [430] "#' "                                                                                                                                                                   
## [431] "#' Analisis de Ecologia Espacial"                                                                                                                                      
## [432] "#'"                                                                                                                                                                    
## [433] "#' Transformar matriz a Hellinger y generar vecindad"                                                                                                                  
## [434] "mi_fam_hel <- decostand (mi_fam, \"hellinger\")"                                                                                                                       
## [435] "bci_env_grid_sp <- bci_env_grid %>% as_Spatial"                                                                                                                        
## [436] "centroides <- bci_env_grid %>% st_centroid"                                                                                                                            
## [437] "bci_xy <- centroides %>% st_coordinates %>% as.data.frame"                                                                                                             
## [438] "(vecindad <- bci_env_grid_sp %>% poly2nb)"                                                                                                                             
## [439] "(pesos_b <- nb2listw(vecindad, style = 'B'))"                                                                                                                          
## [440] "plot(bci_env_grid_sp)"                                                                                                                                                 
## [441] "plot(vecindad, coords = bci_xy, add=T, col = 'red')"                                                                                                                   
## [442] "#'"                                                                                                                                                                    
## [443] "#' Autocorrelacion mediante correlograma para variables ambientales"                                                                                                   
## [444] "bci_env_grid_num <- bci_env_grid %>%"                                                                                                                                  
## [445] "  st_drop_geometry %>% "                                                                                                                                               
## [446] "  select_if(is.numeric) %>% "                                                                                                                                          
## [447] "  select(B, Ca, Mg, Zn, N, pH, N.min.)"                                                                                                                                
## [448] "suppressWarnings(auto_amb <- calcular_autocorrelacion("                                                                                                                
## [449] "  df_fuente = bci_env_grid_num,"                                                                                                                                       
## [450] "  orden = 9,"                                                                                                                                                          
## [451] "  obj_vecindad = vecindad))"                                                                                                                                           
## [452] "print(auto_amb, digits = 2, p.adj.method = 'holm')"                                                                                                                    
## [453] "dim_panel <- rev(n2mfrow(ncol(bci_env_grid_num)))"                                                                                                                     
## [454] "par(mfrow = dim_panel)"                                                                                                                                                
## [455] "suppressWarnings(invisible(lapply(auto_amb, function(x) plot(x, main = x$var))))"                                                                                      
## [456] "#'"                                                                                                                                                                    
## [457] "#' Correlograma de Mantel sin tendencias espaciales"                                                                                                                   
## [458] "mi_fam_sin_tendencia <- resid("                                                                                                                                        
## [459] "  lm(as.matrix(mi_fam_hel) ~ .,"                                                                                                                                       
## [460] "     data = bci_xy))"                                                                                                                                                  
## [461] "mi_fam_sin_tendencia_d <- dist(mi_fam_sin_tendencia)"                                                                                                                  
## [462] "(mi_fam_correlograma <- mantel.correlog("                                                                                                                              
## [463] "  mi_fam_sin_tendencia_d,"                                                                                                                                             
## [464] "  XY = bci_xy,"                                                                                                                                                        
## [465] "  nperm = 999))"                                                                                                                                                       
## [466] "plot(mi_fam_correlograma)"                                                                                                                                             
## [467] "#'"                                                                                                                                                                    
## [468] "#' Calculo de I de Moran y mapas Lisa para especies sin tendencia y algunas variables ambientales"                                                                     
## [469] "#'"                                                                                                                                                                    
## [470] "(autocor_global_residuos <- sapply("                                                                                                                                   
## [471] "  dimnames(mi_fam_sin_tendencia)[[2]],"                                                                                                                                
## [472] "  function(x)"                                                                                                                                                         
## [473] "    moran.mc("                                                                                                                                                         
## [474] "      x = mi_fam_sin_tendencia[,x],"                                                                                                                                   
## [475] "      listw = pesos_b,"                                                                                                                                                
## [476] "      zero.policy = T,"                                                                                                                                                
## [477] "      nsim = 9999),"                                                                                                                                                   
## [478] "  simplify = F))"                                                                                                                                                      
## [479] "#'"                                                                                                                                                                    
## [480] "bci_env_grid_num_sf <- bci_env_grid %>%"                                                                                                                               
## [481] "  select_if(is.numeric) %>% "                                                                                                                                          
## [482] "  select(-id, -UTM.EW, -UTM.NS)"                                                                                                                                       
## [483] "bci_env_grid_num_sf %>% tibble"                                                                                                                                        
## [484] "lisamaps_amb <- sapply(grep('geometry', names(bci_env_grid_num_sf), invert = T, value = T),"                                                                           
## [485] "                       function(x) {"                                                                                                                                  
## [486] "                         m <- lisamap(objesp = bci_env_grid_num_sf[x],"                                                                                                
## [487] "                                      var = x,"                                                                                                                        
## [488] "                                      pesos = pesos_b,"                                                                                                                
## [489] "                                      tituloleyenda = 'Significancia (\"x-y\", léase como \"x\" rodeado de \"y\")',"                                                   
## [490] "                                      leyenda = F,"                                                                                                                    
## [491] "                                      anchuratitulo = 50,"                                                                                                             
## [492] "                                      tamanotitulo = 10,"                                                                                                              
## [493] "                                      fuentedatos = '\\nhttp://ctfs.si.edu/webatlas/datasets/bci/',"                                                                   
## [494] "                                      titulomapa = paste0('Clusters LISA de \"', x, '\"'))"                                                                            
## [495] "                         return(m$grafico)"                                                                                                                            
## [496] "                       }, simplify = F"                                                                                                                                
## [497] ")"                                                                                                                                                                     
## [498] "lisamaps_amb$leyenda <- gtable_filter(ggplot_gtable(ggplot_build(lisamaps_amb[[1]] + theme(legend.position=\"bottom\"))), \"guide-box\")"                              
## [499] "grid.arrange(do.call('arrangeGrob', c(lisamaps_amb[1:12], nrow = 3)), lisamaps_amb$leyenda, heights=c(1.1, 0.1), nrow = 2)"                                            
## [500] "grid.arrange(do.call('arrangeGrob', c(lisamaps_amb[13:22], nrow = 3)), lisamaps_amb$leyenda, heights=c(1.1, 0.1), nrow = 2)"                                           
## [501] "grid.arrange(do.call('arrangeGrob', c(lisamaps_amb[23:31], nrow = 3)), lisamaps_amb$leyenda, heights=c(1.1, 0.1), nrow = 2)"                                           
## [502] "#'"                                                                                                                                                                    
## [503] "mi_fam_sintendencia_sf <- bci_env_grid %>% select %>% bind_cols(mi_fam_sin_tendencia %>% as.data.frame)"                                                               
## [504] "lisamaps_mifam_sintendencia <- sapply("                                                                                                                                
## [505] "  grep('geometry', names(mi_fam_sintendencia_sf), invert = T, value = T),"                                                                                             
## [506] "  function(x) {"                                                                                                                                                       
## [507] "    m <- lisamap(objesp = mi_fam_sintendencia_sf[x],"                                                                                                                  
## [508] "                 var = x,"                                                                                                                                             
## [509] "                 pesos = pesos_b,"                                                                                                                                     
## [510] "                 tituloleyenda = 'Significancia (\"x-y\", léase como \"x\" rodeado de \"y\")',"                                                                        
## [511] "                 leyenda = F,"                                                                                                                                         
## [512] "                 anchuratitulo = 50,"                                                                                                                                  
## [513] "                 tamanotitulo = 10,"                                                                                                                                   
## [514] "                 fuentedatos = '\\nhttp://ctfs.si.edu/webatlas/datasets/bci/',"                                                                                        
## [515] "                 titulomapa = paste0('Clusters LISA de \"', x, '\"'))"                                                                                                 
## [516] "    # dev.new();print(m$grafico)"                                                                                                                                      
## [517] "    return(m$grafico)"                                                                                                                                                 
## [518] "  }, simplify = F"                                                                                                                                                     
## [519] ")"                                                                                                                                                                     
## [520] "lisamaps_mifam_sintendencia$leyenda <- gtable_filter(ggplot_gtable(ggplot_build(lisamaps_mifam_sintendencia[[2]] + theme(legend.position=\"bottom\"))), \"guide-box\")"
## [521] "grid.arrange(do.call('arrangeGrob', c(lisamaps_mifam_sintendencia, nrow = 3)), heights=c(1.1, 0.1))"
\end{verbatim}

\section*{Referencias}\label{referencias}
\addcontentsline{toc}{section}{Referencias}

\hypertarget{refs}{}
\hypertarget{ref-bardon2013origin}{}
Bardon, L., Chamagne, J., Dexter, K. G., Sothers, C. A., Prance, G. T.,
\& Chave, J. (2013). Origin and evolution of chrysobalanaceae: Insights
into the evolution of plants in the neotropics. \emph{Botanical Journal
of the Linnean Society}, \emph{171}(1), 19--37.

\hypertarget{ref-jose_ramon_martinez_batlle_2020_4402362}{}
Batlle, J. R. M. (2020). biogeografia-master/scripts-de-analisis-BCI:
Long coding sessions (Version v0.0.0.9000).
\url{https://doi.org/10.5281/zenodo.4402362}

\hypertarget{ref-borcard2011numerical}{}
Borcard, D., Gillet, F., Legendre, P., \& others. (2011).
\emph{Numerical ecology with r} (Vol. 2). Springer.

\hypertarget{ref-cantrell2010spatial}{}
Cantrell, R. S., Cosner, C., \& Ruan, S. (2010). \emph{Spatial ecology}.
CRC Press.

\hypertarget{ref-condit1998tropical}{}
Condit, R. (1998). \emph{Tropical forest census plots: Methods and
results from barro colorado island, panama and a comparison with other
plots}. Springer Science \& Business Media.

\hypertarget{ref-condit1996species}{}
Condit, R., Hubbell, S. P., Lafrankie, J. V., Sukumar, R., Manokaran,
N., Foster, R. B., \& Ashton, P. S. (1996). Species-area and
species-individual relationships for tropical trees: A comparison of
three 50-ha plots. \emph{Journal of Ecology}, 549--562.

\hypertarget{ref-croat1978flora}{}
Croat, T. B. (1978). \emph{Flora of barro colorado island}. Stanford
University Press.

\hypertarget{ref-indicspeciesR}{}
De Caceres, M., \& Legendre, P. (2009). Associations between species and
groups of sites: Indices and statistical inference. In \emph{Ecology}.
Retrieved from \url{http://sites.google.com/site/miqueldecaceres/}

\hypertarget{ref-feitosa2012chrysobalanaceae}{}
Feitosa, E. A., Xavier, H. S., \& Randau, K. P. (2012).
Chrysobalanaceae: Traditional uses, phytochemistry and pharmacology.
\emph{Revista Brasileira de Farmacognosia}, \emph{22}(5), 1181--1186.

\hypertarget{ref-PfafLrigida}{}
Future, P. for a. (2021). Licania rigida (benth). Retrieved November 11,
2021, from
\url{https://pfaf.org/user/Plant.aspx?LatinName=Licania+rigida}

\hypertarget{ref-grandtner2013dictionary}{}
Grandtner, M. M., \& Chevrette, J. (2013). \emph{Dictionary of trees,
volume 2: South america: Nomenclature, taxonomy and ecology}. Academic
Press.

\hypertarget{ref-hubbell1992short}{}
Hubbell, S. P., \& Foster, R. B. (1992). Short-term dynamics of a
neotropical forest: Why ecological research matters to tropical
conservation and management. \emph{Oikos}, 48--61.

\hypertarget{ref-Hubbell2010Forest}{}
Hubbell, S., Condit, R., \& Foster, R. (2010). Forest census plot on
barro colorado island. Retrieved November 30),, from
\url{http://ctfs.si.edu/webatlas/datasets/bci/}

\hypertarget{ref-biodiversityR}{}
Kindt, R., \& Coe, R. (2005). \emph{Tree diversity analysis. a manual
and software for common statistical methods for ecological and
biodiversity studies}. Retrieved from
\url{http://www.worldagroforestry.org/output/tree-diversity-analysis}

\hypertarget{ref-krebs1999ecological}{}
Krebs, C. J. (2014). \emph{Ecological methodology} (3rd ed.).

\hypertarget{ref-lange2013physiological}{}
Lange, O. L., Nobel, P. S., Osmond, C. B., \& Ziegler, H. (2013).
\emph{Physiological plant ecology iii: Responses to the chemical and
biological environment} (Vol. 12). Springer Science \& Business Media.

\hypertarget{ref-legendre2001ecologically}{}
Legendre, P., \& Gallagher, E. D. (2001). Ecologically meaningful
transformations for ordination of species data. \emph{Oecologia},
\emph{129}(2), 271--280.

\hypertarget{ref-legendre2012numerical}{}
Legendre, P., \& Legendre, L. (2012). \emph{Numerical ecology}.
Elsevier.

\hypertarget{ref-lomolino2017biogeography}{}
Lomolino, M. V., Riddle, B. R., Whittaker, R. J., \& Brown, J. H.
(2010). \emph{Biogeography}.

\hypertarget{ref-magurran2004measuring}{}
Magurran, A. (2004). Measuring biological diversity. 2004. \emph{Malden:
Blackwell}.

\hypertarget{ref-veganR}{}
Oksanen, J., Blanchet, F. G., Friendly, M., Kindt, R., Legendre, P.,
McGlinn, D., \ldots{} Wagner, H. (2019). \emph{Vegan: Community ecology
package}. Retrieved from \url{https://CRAN.R-project.org/package=vegan}

\hypertarget{ref-prance2014chrysobalanaceae}{}
Prance, G. (2014). Chrysobalanaceae. In \emph{Flowering plants.
eudicots} (pp. 19--28). Springer.

\hypertarget{ref-RStudio}{}
R Core Team. (2020). \emph{R: A language and environment for statistical
computing}. Retrieved from \url{https://www.R-project.org/}

\hypertarget{ref-ircCicaco}{}
Regional Conservation, T. I. for. (2020). Chrysobalanus icaco,
chrysobalanaceae. Retrieved November 11, 2021, from
\url{https://regionalconservation.org/beta/nfyn/plantdetail.asp?tx=Chryicac\&tx=Chryicac}

\hypertarget{ref-sang2008vascular}{}
Sang, W., \& Bai, F. (2008). Vascular diversity patterns of forest
ecosystem before and after a 43-year interval under changing climate
conditions in the changbaishan nature reserve, northeastern china. In
\emph{Forest ecology} (pp. 115--130). Springer.

\hypertarget{ref-sothers2014taxonomic}{}
Sothers, C., Prance, G. T., Buerki, S., De Kok, R., \& Chase, M. W.
(2014). Taxonomic novelties in neotropical chrysobalanaceae: Towards a
monophyletic couepia. \emph{Phytotaxa}, \emph{172}(2), 176--200.

\hypertarget{ref-tidyverseR}{}
Wickham, H. (2017). \emph{Tidyverse: Easily install and load the
'tidyverse'}. Retrieved from
\url{https://CRAN.R-project.org/package=tidyverse}




\newpage
\singlespacing 
\end{document}
